GHDL=ghdl
GHDLFLAGS=
MODULES=\
    LIB/LIB_AES/CryptPack.o \
    LIB/LIB_BENCH/sbox_tb.o \
    LIB/LIB_RTL/sbox.o \
    LIB/LIB_BENCH/sbox_tb_conf


test: $(MODULES)
	./sbox_tb_conf --vcd=sbox_tb_conf.vcd

# Binary depends on the object file
sbox_tb_conf: LIB/LIB_BENCH/sbox_tb_conf.o
	$(GHDL) -e --work=lib_bench --workdir=LIB/LIB_BENCH $@

LIB/LIB_AES/CryptPack.o: SRC/THIRDPARTY/CryptPack.vhd
	$(GHDL) -a --work=lib_aes --workdir=LIB/LIB_AES $<

LIB/LIB_BENCH/sbox_tb.o: SRC/BENCH/sbox_tb.vhd LIB/LIB_RTL/sbox.o
	$(GHDL) -a -P./LIB/LIB_AES -P./LIB/LIB_RTL --work=lib_bench --workdir=LIB/LIB_BENCH $<
LIB/LIB_BENCH/sbox_tb_conf.o: SRC/BENCH/sbox_tb_conf.vhd
	$(GHDL) -a -P./LIB/LIB_AES -P./LIB/LIB_RTL --work=lib_bench --workdir=LIB/LIB_BENCH $<

LIB/LIB_RTL/sbox.o: SRC/RTL/sbox.vhd
	$(GHDL) -a -P./LIB/LIB_AES --work=lib_rtl --workdir=LIB/LIB_RTL $<
